# 트랜잭션 격리성 수준


1. ✅ **Dirty Read**: 아직 커밋되지 않은 트랜잭션의 변경 내용을 다른 트랜잭션이 읽을 수 있는 현상
	* 트랜잭션 A가 아직 커밋하지 않았지만 변경 중인 데이터를 트랜잭션 B가 읽었다고 하자. 그런데 트랜잭션 A가 커밋 직전 해당 데이터를 삭제한다면? 트랜잭션 B는 이제 없어진 데이터를 읽은 셈이 됐다. 혹은 트랜잭션 A에 문제가 있어 데이터가 모두 롤백이 된 상황에서도 트랜잭션 B는 마찬가지로 아예 없는 데이터를 읽은 셈이 됐다. 이것이 Dirty Read. 어렵구만?
2. ✅ **Non-repeatable Read**: 하나의 트랜잭션 내에서 동일한 데이터를 여러 번 읽었을 때, 그 사이에 다른 트랜잭션이 해당 데이터를 수정하여 읽기 결과가 달라지는 현상
	* 트랜잭션 A가 특정 행의 데이터를 읽었다고 하자. 이때 트랜잭션 B가 마찬가지로 해당 행의 데이터를 수정하고 커밋까지 완료했다고 하자. 그리고 해당 커밋 이후에 트랜잭션 A가 다시 한번 같은 행의 데이터를 읽는다면 값이 달라지게 된다. 이것이 Non-repeatable Read임. 
3. ✅ **Phantom Read**: 하나의 트랜잭션 내에서 특정 조건에 맞는 데이터 집합을 여러 번 조회했을 때 그 사이에 다른 트랜잭션이 해당 조건을 만족하는 새로운 행을 삽입하여 조회 결과의 행 개수가 달라짐
	* 트랜잭션 A가 키 170미만인 학급생을 조회함. 트랜잭션 B가 키가 169인 데이터를 하나 추가. 트랜잭션 A가 다시 동일 조건으로 조회하면 새로 삽입된 유령(Phantom)이 추가.  
-> 세 개가 다 비슷비슷 하구만...

## READ UNCOMMITTED(커밋되지 않은 데이터 읽기 가능)
가장 낮은 수준의 격리 레벨. 어떤 제한도 없음. 트랜잭션이 아직 커밋하지 않은 (즉 롤백 가능성도 있는) 데이터도 다른 트랜잭션이 읽을 수 있음. 따라서 Dirty Read가 허용됨. Dirty Read뿐만 아니라 커밋되지 않은 상태의 데이터를 다른 트랜잭션이 접근 가능하니 Non-repeatable Read와 Phantom Read 모두 발생 가능

## Read Committed (커밋되지 않은 데이터만 읽기 가능)
대부분의 DBMS의 기본 격리 수준(Oracle, MSSQL 등) 커밋 완료된 데이터만 읽기 가능하기에 Dirty Read 방지. 그러나 Non-repeatable Read와 Phantom Read는 여전히 발생이 가능함. 왜 그럴까?
트랜잭션 A가 이전의 커밋된 데이터를 두 번 읽어야 하는 상황에서 첫 번째 읽었을 때와 두 번째 읽기 시도 사이에 다른 트랜잭션이 해당 데이터에 변형을 가할 수 있기에 Non-repeatable Read가 발생할 가능성이 있음. 또한 Phantom Read도 마찬가지

## Repetable Read (반복 가능한 읽기) 
**한 트랜잭션 내에서는 동일 쿼리를 반복 실행해도 항상 같은 결과 보장**. 즉 Dirty Read와 Non-repeatable Read 방지

트랜잭션 A가 범위 안의 어떤 행을 읽은 상황에서, 트랜잭션 A가 종료(Commit)할 때까지는 다른 트랜잭션이 **해당 행을 수정하거나 삭제한** 흔적이 트랜잭션 A에게는 보이지 않음. 즉, Non-repeatable Read 방지됨. MySQL InnoDB의 기본 격리 수준. 하지만 여기서 주의해야 할 점은 수정 및 삭제한 행만 보이지 않는 것임. 즉, 행이 추가가 된 경우는 노출이 됨. 다시 말하면 Phantom Read는 발생한다.

## Serializable (직렬화 가능)
가장 높은 격리 수준으로 모든 트랜잭션을 순차적으로 실행한 것과 동일한 결과 보장. (이렇게 하면 성능은 안 좋을 듯) 사실상 완전한 고립으로 [Dirty Read, Non-repeatable Read, Phontom Read]가 모두 방지됨. 구현상으로는 트랜잭션이 읽는 모든 레코드에 공유 락(또는 MVVC 스냅샷) 등을 걸어, 다른 트랜잭션이 해당 영역에 삽입/삭제/수정을 하지 못하게 함.


## 요약
- Dirty Read (다른 Tx 미커밋 데이터 읽음): RU만 허용, RC부터는 불가 .
- Non-repeatable Read (같은 쿼리 두번에 값 달라짐): RU, RC에서 발생, RR부터는 불가 .
- Phantom Read (같은 조건 두번 조회에 행 추가/삭제 발생): RU, RC, RR에서 발생 가능, Serializable에서만 불가




